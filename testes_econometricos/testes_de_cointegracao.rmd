---
title: "Testes de cointegração"
output: pdf_document
---

```{r, include = F, echo = FALSE}

knitr::opts_chunk$set(comment = NA, warning = FALSE, message = FALSE)

library(tidyverse)
library(tseries)

series <- read_csv("~/Documentos/mono/dados/series_economicas_log.csv")

series_estacionarias <-
  read_csv("~/Documentos/mono/testes_econometricos/resultados_teste_raiz_unitaria.csv") %>%
  filter(diagnostico == "estacionário") %>% pull(variavel) %>% unique

```

# Testes de co-integração para várias combinações das variáveis

$$ \text{spread} = \beta_0 + \beta_1\text{selic} + \beta_2\text{inad} + \beta_3\text{pib\_mensal} + \beta_4\text{igp\_di} + \beta_5\text{ihh} $$

```{r, echo = T, include = T}
# po.test do tseries
# ca.po do urca
# referência: https://www.r-bloggers.com/phillips-ouliaris-test-for-cointegration/

```

```{r, echo = F, include = T}

library(egcm)

ca.po.teststat <- function(SERIES) {
  SERIES %>% urca::ca.po(type = "Pz") %>% `@`("teststat")
}

ca.po.cval <- function(SERIES) {
  SERIES %>% urca::ca.po(type = "Pz") %>% `@`("cval") %>% `[`(2)
}

series_combinadas <-
  series %>% select(-date, -series_estacionarias) %>%
  names %>%
  combn(2) %>%
  t %>% as.data.frame %>%
  rowwise %>%
  mutate(df = subset(series, select = c(V1, V2)) %>% list) %>%
  ungroup

```

# Teste de Johansen

